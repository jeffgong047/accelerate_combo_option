
Generating frontier for markets:   0%|                                                               | 0/19 [00:00<?, ?it/s]
There are 27 buy orders and 23 sell orders
#####Generating market 1 with size 50 and noise 0.015625#####
Starting computation for iteration 1
Generating frontier for markets:   0%|                                                               | 0/19 [00:00<?, ?it/s]/common/home/hg343/Research/accelerate_combo_option/src/market.py:265: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  frontier_labels = pd.Series(None, index=orders.index)
Processing order 1 (1/37)
checking match False -0.0
quote_price: 0.53, original_price: 0.53
Processing order 2 (2/37)
checking match False -0.0
quote_price: 0.03, original_price: 0.03
Processing order 3 (3/37)
checking match False -0.0
quote_price: 45.17999999999559, original_price: 45.18
Processing order 4 (4/37)
checking match False -0.0
quote_price: 20.75999999999852, original_price: 20.76
Processing order 5 (5/37)
checking match False -0.0
quote_price: 0.09, original_price: 0.09
Processing order 6 (6/37)
checking match False -0.0
quote_price: 15.610161695250774, original_price: 13.61
Processing order 7 (7/37)
checking match False -0.0
quote_price: 0.03, original_price: 0.03
Processing order 8 (8/37)
checking match False -0.0
quote_price: 41.36000000000006, original_price: 41.36
Processing order 9 (9/37)
checking match False -0.0
quote_price: 57.91632971790204, original_price: 58.19
Processing order 10 (10/37)
checking match False -0.0
quote_price: 147.13, original_price: 147.13
Processing order 13 (11/37)
checking match False -0.0
quote_price: 0.02, original_price: 0.02
Processing order 14 (12/37)
checking match False -0.0
quote_price: 0.06, original_price: 0.06
Processing order 15 (13/37)
checking match False -0.0
quote_price: 0.04, original_price: 0.04
Processing order 16 (14/37)
checking match False -0.0
quote_price: 68.10046253128237, original_price: 63.68
Processing order 17 (15/37)
checking match False -0.0
quote_price: 141.41, original_price: 141.41
Processing order 18 (16/37)
checking match False -0.0
quote_price: 87.64, original_price: 87.64
Processing order 19 (17/37)
checking match False -0.0
quote_price: 0.08, original_price: 0.08
Processing order 20 (18/37)
checking match False -0.0
quote_price: 3.11, original_price: 3.11
Processing order 21 (19/37)
checking match False -0.0
quote_price: 218.33, original_price: 218.33
Processing order 22 (20/37)
checking match False -0.0
quote_price: 7.03000000000009, original_price: 7.03
Processing order 23 (21/37)
checking match False -0.0
quote_price: 3.78, original_price: 3.78
Processing order 24 (22/37)
checking match False -0.0
quote_price: 154.96, original_price: 154.96
Processing order 25 (23/37)
checking match False -0.0
quote_price: 22.04, original_price: 22.04
Processing order 26 (24/37)
checking match False -0.0
quote_price: 192.05394078190452, original_price: 191.55
Processing order 28 (25/37)
checking match False -0.0
quote_price: 5.0, original_price: 5.0
Processing order 29 (26/37)
checking match False -0.0
quote_price: 433.8199999999488, original_price: 433.82
Processing order 31 (27/37)
checking match False -0.0
quote_price: 14.930000000051223, original_price: 14.93
Processing order 33 (28/37)
checking match False -0.0
quote_price: 21.06000000005588, original_price: 21.06
Processing order 35 (29/37)
checking match False -0.0
quote_price: 2.1899999999441206, original_price: 2.19
Processing order 37 (30/37)
checking match False -0.0
quote_price: 2.3299999999580905, original_price: 2.33
Processing order 39 (31/37)
checking match False -0.0
quote_price: 0.15000000002328306, original_price: 0.15
Processing order 42 (32/37)
checking match False -0.0
quote_price: 90.03000000002794, original_price: 90.03
Processing order 43 (33/37)
checking match False -0.0
quote_price: 2.4100000000325963, original_price: 2.41
Processing order 44 (34/37)
checking match False -0.0
quote_price: 62.63000000000466, original_price: 62.63
Processing order 47 (35/37)
checking match False -0.0
quote_price: 40.26000000000931, original_price: 40.26
Processing order 48 (36/37)
checking match False -0.0
quote_price: 6.369999999995343, original_price: 6.37
Processing order 49 (37/37)
checking match False -0.0
/common/home/hg343/Research/accelerate_combo_option/src/market.py:265: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  frontier_labels = pd.Series(None, index=orders.index)
quote_price: 0.10999999998603016, original_price: 0.11
    option1  option2  C=Call, P=Put  ...  B/A_price  liquidity  belongs_to_frontier
1       5.0      2.0           -1.0  ...       0.53          1                  1.0
2       2.0     -1.0            1.0  ...       0.03          1                  1.0
3       1.0      3.0            1.0  ...      45.18          1                  1.0
4       1.0      1.0           -1.0  ...      20.76          1                  1.0
5       8.0     -7.0            1.0  ...       0.09          1                  1.0
6      -1.0      2.0           -1.0  ...      13.61          1                  0.0
7       2.0     -1.0            1.0  ...       0.03          1                  1.0
8       3.0      7.0            1.0  ...      41.36          1                  0.0
9       4.0      1.0            1.0  ...      58.19          1                  1.0
10      7.0      2.0            1.0  ...     147.13          1                  1.0
13      3.0     -1.0           -1.0  ...       0.02          1                  1.0
14     -1.0      9.0           -1.0  ...       0.06          1                  1.0
15      3.0      1.0           -1.0  ...       0.04          1                  1.0
16      4.0     -5.0            1.0  ...      63.68          1                  0.0
17      9.0     -2.0           -1.0  ...     141.41          1                  1.0
18      3.0      1.0            1.0  ...      87.64          1                  1.0
19      5.0      4.0           -1.0  ...       0.08          1                  1.0
20      5.0      1.0            1.0  ...       3.11          1                  1.0
21      5.0     -3.0           -1.0  ...     218.33          1                  1.0
22      3.0     -4.0           -1.0  ...       7.03          1                  0.0
23      4.0     -3.0           -1.0  ...       3.78          1                  1.0
24      4.0      5.0            1.0  ...     154.96          1                  1.0
25      1.0     -1.0           -1.0  ...      22.04          1                  1.0
26      9.0     -2.0            1.0  ...     191.55          1                  0.0
28      8.0     -3.0           -1.0  ...       5.00          1                  1.0
29      9.0      2.0           -1.0  ...     433.82          1                  0.0
31      2.0      3.0            1.0  ...      14.93          1                  1.0
33      2.0     -1.0            1.0  ...      21.06          1                  1.0
35      3.0     -1.0           -1.0  ...       2.19          1                  0.0
37      8.0      9.0           -1.0  ...       2.33          1                  0.0
39     -1.0      3.0           -1.0  ...       0.15          1                  1.0
42      9.0      8.0            1.0  ...      90.03          1                  1.0
43      7.0      2.0           -1.0  ...       2.41          1                  1.0
44      9.0      7.0           -1.0  ...      62.63          1                  1.0
47      1.0      4.0            1.0  ...      40.26          1                  1.0
48      5.0      8.0           -1.0  ...       6.37          1                  0.0
49      7.0     -4.0            1.0  ...       0.11          1                  0.0
[37 rows x 8 columns]
checking match False -0.0
Processing order 1 (1/37)
checking match False -0.0
quote_price: 0.53, original_price: 0.53
Processing order 2 (2/37)
checking match False -0.0
quote_price: 0.03, original_price: 0.03
Processing order 3 (3/37)
checking match False -0.0
quote_price: 45.17999999999993, original_price: 45.18
Processing order 4 (4/37)
checking match False -0.0
quote_price: 20.7599606738056, original_price: 20.76
Processing order 5 (5/37)
checking match False -0.0
quote_price: 0.09, original_price: 0.09
Processing order 6 (6/37)
checking match False -0.0
quote_price: 15.61016169525077, original_price: 13.61
Processing order 7 (7/37)
checking match False -0.0
quote_price: 0.03, original_price: 0.03
Processing order 8 (8/37)
checking match False -0.0
quote_price: 41.36, original_price: 41.36
Processing order 9 (9/37)
checking match False -0.0
quote_price: 57.908649589709825, original_price: 58.19
Processing order 10 (10/37)
checking match False -0.0
quote_price: 147.12999999899407, original_price: 147.13
Processing order 13 (11/37)
checking match False -0.0
quote_price: 0.02, original_price: 0.02
Processing order 14 (12/37)
checking match False -0.0
quote_price: 0.06, original_price: 0.06
Processing order 15 (13/37)
checking match False -0.0
quote_price: 0.04, original_price: 0.04
Processing order 16 (14/37)
checking match False -0.0
quote_price: 69.24168589892936, original_price: 63.68
Processing order 17 (15/37)
checking match False -0.0
quote_price: 141.41, original_price: 141.41
Processing order 18 (16/37)
checking match False -0.0
quote_price: 87.64, original_price: 87.64
Processing order 19 (17/37)
checking match False -0.0
quote_price: 0.08, original_price: 0.08
Processing order 20 (18/37)
checking match False -0.0
quote_price: 3.11, original_price: 3.11
Processing order 21 (19/37)
checking match False -0.0
quote_price: 218.33, original_price: 218.33
Processing order 22 (20/37)
checking match False -0.0
quote_price: 7.03, original_price: 7.03
Processing order 23 (21/37)
checking match False -0.0
quote_price: 3.78, original_price: 3.78
Processing order 24 (22/37)
checking match False -0.0
quote_price: 154.95999999999992, original_price: 154.96
Processing order 25 (23/37)
checking match False -0.0
quote_price: 22.04, original_price: 22.04
Processing order 26 (24/37)
checking match False -0.0
quote_price: 193.16806353104172, original_price: 191.55
Processing order 28 (25/37)
checking match False -0.0
quote_price: 5.0, original_price: 5.0
Processing order 29 (26/37)
checking match False -0.0
quote_price: 433.8199999999488, original_price: 433.82
Processing order 31 (27/37)
checking match False -0.0
quote_price: 14.930000000051223, original_price: 14.93
Processing order 33 (28/37)
checking match False -0.0
quote_price: 21.06000000005588, original_price: 21.06
Processing order 35 (29/37)
checking match False -0.0
quote_price: 2.1900000021560118, original_price: 2.19
Processing order 37 (30/37)
checking match False -0.0
quote_price: 2.3299999999580905, original_price: 2.33
Processing order 39 (31/37)
checking match False -0.0
quote_price: 0.15000000002328306, original_price: 0.15
Processing order 42 (32/37)
checking match False -0.0
quote_price: 90.03000000002794, original_price: 90.03
Processing order 43 (33/37)
checking match False -0.0
quote_price: 2.4100000000325963, original_price: 2.41
Processing order 44 (34/37)
checking match False -0.0
quote_price: 62.63000000000466, original_price: 62.63
Processing order 47 (35/37)
checking match False -0.0
quote_price: 40.26000000000931, original_price: 40.26
Processing order 48 (36/37)
checking match False -0.0
quote_price: 6.369999999995343, original_price: 6.37
Processing order 49 (37/37)
checking match False -0.0
quote_price: 0.11000000010244548, original_price: 0.11
    option1  option2  C=Call, P=Put  ...  B/A_price  liquidity  belongs_to_frontier
1       5.0      2.0           -1.0  ...       0.53          1                  1.0
2       2.0     -1.0            1.0  ...       0.03          1                  1.0
3       1.0      3.0            1.0  ...      45.18          1                  1.0
4       1.0      1.0           -1.0  ...      20.76          1                  1.0
5       8.0     -7.0            1.0  ...       0.09          1                  1.0
6      -1.0      2.0           -1.0  ...      13.61          1                  0.0
7       2.0     -1.0            1.0  ...       0.03          1                  1.0
8       3.0      7.0            1.0  ...      41.36          1                  1.0
9       4.0      1.0            1.0  ...      58.19          1                  1.0
10      7.0      2.0            1.0  ...     147.13          1                  1.0
13      3.0     -1.0           -1.0  ...       0.02          1                  1.0
14     -1.0      9.0           -1.0  ...       0.06          1                  1.0
15      3.0      1.0           -1.0  ...       0.04          1                  1.0
16      4.0     -5.0            1.0  ...      63.68          1                  0.0
17      9.0     -2.0           -1.0  ...     141.41          1                  1.0
18      3.0      1.0            1.0  ...      87.64          1                  1.0
19      5.0      4.0           -1.0  ...       0.08          1                  1.0
20      5.0      1.0            1.0  ...       3.11          1                  1.0
21      5.0     -3.0           -1.0  ...     218.33          1                  1.0
22      3.0     -4.0           -1.0  ...       7.03          1                  1.0
23      4.0     -3.0           -1.0  ...       3.78          1                  1.0
24      4.0      5.0            1.0  ...     154.96          1                  1.0
25      1.0     -1.0           -1.0  ...      22.04          1                  1.0
26      9.0     -2.0            1.0  ...     191.55          1                  0.0
28      8.0     -3.0           -1.0  ...       5.00          1                  1.0
29      9.0      2.0           -1.0  ...     433.82          1                  0.0
31      2.0      3.0            1.0  ...      14.93          1                  1.0
33      2.0     -1.0            1.0  ...      21.06          1                  1.0
35      3.0     -1.0           -1.0  ...       2.19          1                  1.0
37      8.0      9.0           -1.0  ...       2.33          1                  0.0
39     -1.0      3.0           -1.0  ...       0.15          1                  1.0
42      9.0      8.0            1.0  ...      90.03          1                  1.0
43      7.0      2.0           -1.0  ...       2.41          1                  1.0
44      9.0      7.0           -1.0  ...      62.63          1                  1.0
47      1.0      4.0            1.0  ...      40.26          1                  1.0
48      5.0      8.0           -1.0  ...       6.37          1                  0.0
49      7.0     -4.0            1.0  ...       0.11          1                  1.0
[37 rows x 8 columns]
frontier_option_label_epsilon:     option1  option2  C=Call, P=Put  ...  B/A_price  liquidity  belongs_to_frontier
1       5.0      2.0           -1.0  ...       0.53          1                  1.0
2       2.0     -1.0            1.0  ...       0.03          1                  1.0
3       1.0      3.0            1.0  ...      45.18          1                  1.0
4       1.0      1.0           -1.0  ...      20.76          1                  1.0
5       8.0     -7.0            1.0  ...       0.09          1                  1.0
6      -1.0      2.0           -1.0  ...      13.61          1                  0.0
7       2.0     -1.0            1.0  ...       0.03          1                  1.0
8       3.0      7.0            1.0  ...      41.36          1                  1.0
9       4.0      1.0            1.0  ...      58.19          1                  1.0
10      7.0      2.0            1.0  ...     147.13          1                  1.0
13      3.0     -1.0           -1.0  ...       0.02          1                  1.0
14     -1.0      9.0           -1.0  ...       0.06          1                  1.0
15      3.0      1.0           -1.0  ...       0.04          1                  1.0
16      4.0     -5.0            1.0  ...      63.68          1                  0.0
17      9.0     -2.0           -1.0  ...     141.41          1                  1.0
18      3.0      1.0            1.0  ...      87.64          1                  1.0
19      5.0      4.0           -1.0  ...       0.08          1                  1.0
20      5.0      1.0            1.0  ...       3.11          1                  1.0
21      5.0     -3.0           -1.0  ...     218.33          1                  1.0
22      3.0     -4.0           -1.0  ...       7.03          1                  1.0
23      4.0     -3.0           -1.0  ...       3.78          1                  1.0
24      4.0      5.0            1.0  ...     154.96          1                  1.0
25      1.0     -1.0           -1.0  ...      22.04          1                  1.0
26      9.0     -2.0            1.0  ...     191.55          1                  0.0
28      8.0     -3.0           -1.0  ...       5.00          1                  1.0
29      9.0      2.0           -1.0  ...     433.82          1                  0.0
31      2.0      3.0            1.0  ...      14.93          1                  1.0
33      2.0     -1.0            1.0  ...      21.06          1                  1.0
35      3.0     -1.0           -1.0  ...       2.19          1                  1.0
37      8.0      9.0           -1.0  ...       2.33          1                  0.0
39     -1.0      3.0           -1.0  ...       0.15          1                  1.0
42      9.0      8.0            1.0  ...      90.03          1                  1.0
43      7.0      2.0           -1.0  ...       2.41          1                  1.0
44      9.0      7.0           -1.0  ...      62.63          1                  1.0
47      1.0      4.0            1.0  ...      40.26          1                  1.0
48      5.0      8.0           -1.0  ...       6.37          1                  0.0
49      7.0     -4.0            1.0  ...       0.11          1                  1.0
[37 rows x 8 columns]
frontier_option_regular:     option1  option2  C=Call, P=Put  ...  B/A_price  liquidity  belongs_to_frontier
1       5.0      2.0           -1.0  ...       0.53          1                  1.0
2       2.0     -1.0            1.0  ...       0.03          1                  1.0
3       1.0      3.0            1.0  ...      45.18          1                  1.0
4       1.0      1.0           -1.0  ...      20.76          1                  1.0
5       8.0     -7.0            1.0  ...       0.09          1                  1.0
6      -1.0      2.0           -1.0  ...      13.61          1                  0.0
7       2.0     -1.0            1.0  ...       0.03          1                  1.0
8       3.0      7.0            1.0  ...      41.36          1                  0.0
9       4.0      1.0            1.0  ...      58.19          1                  1.0
10      7.0      2.0            1.0  ...     147.13          1                  1.0
13      3.0     -1.0           -1.0  ...       0.02          1                  1.0
14     -1.0      9.0           -1.0  ...       0.06          1                  1.0
15      3.0      1.0           -1.0  ...       0.04          1                  1.0
16      4.0     -5.0            1.0  ...      63.68          1                  0.0
17      9.0     -2.0           -1.0  ...     141.41          1                  1.0
18      3.0      1.0            1.0  ...      87.64          1                  1.0
19      5.0      4.0           -1.0  ...       0.08          1                  1.0
20      5.0      1.0            1.0  ...       3.11          1                  1.0
21      5.0     -3.0           -1.0  ...     218.33          1                  1.0
22      3.0     -4.0           -1.0  ...       7.03          1                  0.0
23      4.0     -3.0           -1.0  ...       3.78          1                  1.0
24      4.0      5.0            1.0  ...     154.96          1                  1.0
25      1.0     -1.0           -1.0  ...      22.04          1                  1.0
26      9.0     -2.0            1.0  ...     191.55          1                  0.0
28      8.0     -3.0           -1.0  ...       5.00          1                  1.0
29      9.0      2.0           -1.0  ...     433.82          1                  0.0
31      2.0      3.0            1.0  ...      14.93          1                  1.0
33      2.0     -1.0            1.0  ...      21.06          1                  1.0
35      3.0     -1.0           -1.0  ...       2.19          1                  0.0
37      8.0      9.0           -1.0  ...       2.33          1                  0.0
39     -1.0      3.0           -1.0  ...       0.15          1                  1.0
42      9.0      8.0            1.0  ...      90.03          1                  1.0
43      7.0      2.0           -1.0  ...       2.41          1                  1.0
44      9.0      7.0           -1.0  ...      62.63          1                  1.0
47      1.0      4.0            1.0  ...      40.26          1                  1.0
48      5.0      8.0           -1.0  ...       6.37          1                  0.0
49      7.0     -4.0            1.0  ...       0.11          1                  0.0
[37 rows x 8 columns]
1      True
2      True
3      True
4      True
5      True
6      True
7      True
8     False
9      True
10     True
13     True
14     True
15     True
16     True
17     True
18     True
19     True
20     True
21     True
22    False
23     True
24     True
25     True
26     True
28     True
29     True
31     True
33     True
35    False
37     True
39     True
42     True
43     True
44     True
47     True
48     True
49    False
Name: belongs_to_frontier, dtype: bool
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py(170)<module>()
-> if frontier_option_label_epsilon is not None and not np.isnan(frontier_option_label_epsilon['belongs_to_frontier']).any():
Traceback (most recent call last):
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 170, in <module>
    if frontier_option_label_epsilon is not None and not np.isnan(frontier_option_label_epsilon['belongs_to_frontier']).any():
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 170, in <module>
    if frontier_option_label_epsilon is not None and not np.isnan(frontier_option_label_epsilon['belongs_to_frontier']).any():
  File "/common/home/hg343/anaconda3/lib/python3.9/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/common/home/hg343/anaconda3/lib/python3.9/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
Generating frontier for markets:   5%|██▋                                                 | 1/19 [04:52<1:27:36, 292.01s/it]
Traceback (most recent call last):
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 160, in <module>
    is_match, profit = market.check_match()
  File "/common/home/hg343/Research/accelerate_combo_option/src/market.py", line 82, in check_match
    is_match, profit = self.apply_mechanism(orders, offset=offset)
  File "/common/home/hg343/Research/accelerate_combo_option/src/market.py", line 137, in apply_mechanism
    result = async_result.get(timeout=timeout)
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 765, in get
    self.wait(timeout)
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 762, in wait
    self._event.wait(timeout)
  File "/common/home/hg343/anaconda3/lib/python3.9/threading.py", line 574, in wait
    signaled = self._cond.wait(timeout)
  File "/common/home/hg343/anaconda3/lib/python3.9/threading.py", line 316, in wait
    gotit = waiter.acquire(True, timeout)
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 60, in signal_handler
    sys.exit(1)
  File "/common/home/hg343/anaconda3/lib/python3.9/site-packages/wandb/sdk/lib/exit_hooks.py", line 36, in exit
    self._orig_exit(orig_code)  # type: ignore
SystemExit: 1
Error processing market 1:
There are 31 buy orders and 19 sell orders
#####Generating market 2 with size 50 and noise 0.015625#####
Starting computation for iteration 2
Ctrl+C received. Terminating processes...