Generating frontier for markets:   0%|                                                                                                     | 0/18 [00:00<?, ?it/s]/common/home/hg343/Research/accelerate_combo_option/src/market.py:274: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  frontier_labels = pd.Series(None, index=orders.index)
/common/home/hg343/Research/accelerate_combo_option/src/market.py:275: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  quote_prices = pd.Series(None, index=orders.index)  # Create a Series to store quote prices
There are 31 buy orders and 19 sell orders
#####Generating market 2 with size 50 and noise 0.015625#####
Starting computation for iteration 2
checking match False -0.0
Processing order 0 (1/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      8.0      1.0            1.0                                 1013.0    259.536               1.0          1
quote price: 239.5
quote_price: 239.5, original_price: 259.536
Processing order 1 (2/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote     -1.0      3.0            1.0                                  149.5     13.528               1.0          1
quote price: 8.74
quote_price: 8.74, original_price: 13.528
Processing order 2 (3/50)
checking match False -0.0
No valid quote price for order 2
Processing order 3 (4/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      1.0     -1.0            1.0                                   36.5      6.824               1.0          1
quote price: 2.57
quote_price: 2.57, original_price: 6.824
Processing order 4 (5/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      2.0     -1.0           -1.0                                  180.0      0.544               1.0          1
quote price: -0.0
quote_price: -0.0, original_price: 0.544
Processing order 5 (6/50)
checking match False -0.0
No valid quote price for order 5
Processing order 6 (7/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      8.0      3.0           -1.0                                 1331.5      0.128               1.0          1
quote price: -0.0
quote_price: -0.0, original_price: 0.128
Processing order 7 (8/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      7.0     -4.0           -1.0                                  624.0      8.032               1.0          1
quote price: 0.53
quote_price: 0.53, original_price: 8.032
Processing order 8 (9/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      3.0      4.0            1.0                                  728.0    127.864               1.0          1
quote price: 126.73
quote_price: 126.73, original_price: 127.86400000000002
Processing order 9 (10/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      7.0      3.0           -1.0                                 1392.0     11.736               1.0          1
quote price: 0.13
quote_price: 0.13, original_price: 11.736
Processing order 10 (11/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      9.0     -8.0           -1.0                                  750.0    171.288               1.0          1
quote price: 142.01
quote_price: 142.01, original_price: 171.288
Processing order 11 (12/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      6.0     -1.0            1.0                                  720.0     77.168               1.0          1
quote price: 62.5
quote_price: 62.5, original_price: 77.168
Processing order 12 (13/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      7.0      6.0            1.0                                 1413.0    245.128               1.0          1
quote price: 240.33
quote_price: 240.33, original_price: 245.12800000000004
Processing order 13 (14/50)
checking match False -0.0
No valid quote price for order 13
Processing order 14 (15/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      1.0     -1.0           -1.0                                   47.0      1.296               1.0          1
quote price: 0.83
quote_price: 0.83, original_price: 1.2960000000000003
Processing order 15 (16/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      1.0      1.0           -1.0                                  301.5     31.632               1.0          1
quote price: 24.03
quote_price: 24.03, original_price: 31.632
Processing order 16 (17/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      4.0      3.0            1.0                                  769.5    132.696               1.0          1
quote price: 132.62
quote_price: 132.62, original_price: 132.696
Processing order 17 (18/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      4.0      1.0            1.0                                  643.5     63.904               1.0          1
quote price: 54.75
quote_price: 54.75, original_price: 63.903999999999996
Processing order 18 (19/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      3.0      5.0            1.0                                  990.0      4.184               1.0          1
quote price: -0.0
quote_price: -0.0, original_price: 4.184
Processing order 19 (20/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      8.0      1.0           -1.0                                 1402.0     54.968               1.0          1
quote price: 15.71
quote_price: 15.71, original_price: 54.967999999999996
Processing order 20 (21/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote     -1.0      2.0            1.0                                   46.0     10.632               1.0          1
quote price: 8.27
quote_price: 8.27, original_price: 10.632
Processing order 21 (22/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      5.0      2.0            1.0                                 1032.5      1.032               1.0          1
quote price: -0.0
quote_price: -0.0, original_price: 1.032
Processing order 22 (23/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      7.0      4.0            1.0                                 1591.0      0.144               1.0          1
quote price: -0.0
quote_price: -0.0, original_price: 0.144
Processing order 23 (24/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      7.0      6.0           -1.0                                 1696.0      1.968               1.0          1
quote price: -0.0
quote_price: -0.0, original_price: 1.968
Processing order 24 (25/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      5.0      9.0            1.0                                 1630.5      78.28               1.0          1
quote price: 45.12
quote_price: 45.12, original_price: 78.28
Processing order 25 (26/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote     -1.0      6.0           -1.0                                  580.0     66.232               1.0          1
quote price: 34.98
quote_price: 34.98, original_price: 66.23200000000001
Processing order 26 (27/50)
checking match False -0.0
No valid quote price for order 26
Processing order 27 (28/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      6.0      1.0            1.0                                  992.0     37.992               1.0          1
quote price: 12.84
quote_price: 12.84, original_price: 37.992000000000004
Processing order 28 (29/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      2.0     -3.0           -1.0                                   83.5     76.904               1.0          1
quote price: 71.4
quote_price: 71.4, original_price: 76.904
Processing order 29 (30/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      5.0      7.0            1.0                                 1188.5    263.112               1.0          1
quote price: 257.87
quote_price: 257.87, original_price: 263.112
Processing order 30 (31/50)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity
quote      1.0      4.0            1.0                                  596.0      0.536               1.0          1
quote price: -0.0
quote_price: -0.0, original_price: 0.536
Processing order 31 (32/50)
checking match False -0.0
quote_price: 31.65, original_price: 11.604
Processing order 32 (33/50)
checking match False -0.0
quote_price: 11.47, original_price: 1.452
Processing order 33 (34/50)
checking match False -0.0
quote_price: 17.16, original_price: 5.904
Processing order 34 (35/50)
checking match False -0.0
quote_price: 220.79, original_price: 202.89600000000002
Processing order 35 (36/50)
checking match False -0.0
quote_price: 6.64, original_price: 2.868
Processing order 36 (37/50)
checking match False -0.0
quote_price: 20.48, original_price: 13.607999999999999
Processing order 37 (38/50)
checking match False -0.0
quote_price: 105.25, original_price: 26.987999999999996
Processing order 38 (39/50)
checking match False -0.0
quote_price: 292.56, original_price: 210.9
Processing order 39 (40/50)
checking match False -0.0
quote_price: 97.6, original_price: 14.652000000000001
Processing order 40 (41/50)
checking match False -0.0
quote_price: 4.24, original_price: 3.564
Processing order 41 (42/50)
checking match False -0.0
quote_price: 1.25, original_price: 1.14
Processing order 42 (43/50)
checking match False -0.0
quote_price: 139.01, original_price: 51.876
Processing order 43 (44/50)
checking match False -0.0
quote_price: 60.04, original_price: 41.556000000000004
Processing order 44 (45/50)
checking match False -0.0
quote_price: 84.18, original_price: 24.468
Processing order 45 (46/50)
checking match False -0.0
quote_price: 6.32, original_price: 3.1079999999999997
Processing order 46 (47/50)
checking match False -0.0
quote_price: 2.19, original_price: 0.48
Processing order 47 (48/50)
checking match False -0.0
quote_price: 1.98, original_price: 1.908
Processing order 48 (49/50)
checking match False -0.0
quote_price: 8.81, original_price: 4.74
Processing order 49 (50/50)
checking match False -0.0
quote_price: 23.56, original_price: 18.084
    option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  B/A_price  transaction_type  liquidity  belongs_to_frontier
0       8.0      1.0            1.0                                 1013.0    259.536               1.0          1                  1.0
1      -1.0      3.0            1.0                                  149.5     13.528               1.0          1                  1.0
2       3.0      5.0           -1.0                                  953.0      0.024               1.0          1                  NaN
3       1.0     -1.0            1.0                                   36.5      6.824               1.0          1                  1.0
4       2.0     -1.0           -1.0                                  180.0      0.544               1.0          1                  1.0
5       1.0      7.0           -1.0                                  852.0      1.696               1.0          1                  NaN
6       8.0      3.0           -1.0                                 1331.5      0.128               1.0          1                  1.0
7       7.0     -4.0           -1.0                                  624.0      8.032               1.0          1                  1.0
8       3.0      4.0            1.0                                  728.0    127.864               1.0          1                  1.0
9       7.0      3.0           -1.0                                 1392.0     11.736               1.0          1                  1.0
10      9.0     -8.0           -1.0                                  750.0    171.288               1.0          1                  1.0
11      6.0     -1.0            1.0                                  720.0     77.168               1.0          1                  1.0
12      7.0      6.0            1.0                                 1413.0    245.128               1.0          1                  1.0
13      8.0     -7.0            1.0                                  653.0      0.008               1.0          1                  NaN
14      1.0     -1.0           -1.0                                   47.0      1.296               1.0          1                  1.0
15      1.0      1.0           -1.0                                  301.5     31.632               1.0          1                  1.0
16      4.0      3.0            1.0                                  769.5    132.696               1.0          1                  1.0
17      4.0      1.0            1.0                                  643.5     63.904               1.0          1                  1.0
18      3.0      5.0            1.0                                  990.0      4.184               1.0          1                  1.0
19      8.0      1.0           -1.0                                 1402.0     54.968               1.0          1                  1.0
20     -1.0      2.0            1.0                                   46.0     10.632               1.0          1                  1.0
21      5.0      2.0            1.0                                 1032.5      1.032               1.0          1                  1.0
22      7.0      4.0            1.0                                 1591.0      0.144               1.0          1                  1.0
23      7.0      6.0           -1.0                                 1696.0      1.968               1.0          1                  1.0
24      5.0      9.0            1.0                                 1630.5     78.280               1.0          1                  1.0
25     -1.0      6.0           -1.0                                  580.0     66.232               1.0          1                  1.0
26      2.0      9.0           -1.0                                 1155.0      0.072               1.0          1                  NaN
27      6.0      1.0            1.0                                  992.0     37.992               1.0          1                  1.0
28      2.0     -3.0           -1.0                                   83.5     76.904               1.0          1                  1.0
29      5.0      7.0            1.0                                 1188.5    263.112               1.0          1                  1.0
30      1.0      4.0            1.0                                  596.0      0.536               1.0          1                  1.0
31      9.0      8.0           -1.0                                 2043.0     11.604               0.0          1                  1.0
32      9.0      1.0            1.0                                 1685.5      1.452               0.0          1                  1.0
33      2.0      9.0           -1.0                                 1156.0      5.904               0.0          1                  1.0
34     -1.0      5.0            1.0                                  210.0    202.896               0.0          1                  1.0
35      1.0     -1.0           -1.0                                   25.0      2.868               0.0          1                  1.0
36      1.0     -1.0            1.0                                   40.0     13.608               0.0          1                  1.0
37      1.0      9.0           -1.0                                 1100.0     26.988               0.0          1                  1.0
38      3.0      7.0            1.0                                 1032.0    210.900               0.0          1                  1.0
39      9.0      8.0            1.0                                 2378.0     14.652               0.0          1                  1.0
40      3.0      4.0           -1.0                                  802.5      3.564               0.0          1                  1.0
41      1.0      1.0           -1.0                                  236.0      1.140               0.0          1                  1.0
42      9.0     -4.0            1.0                                  972.0     51.876               0.0          1                  1.0
43      2.0      1.0           -1.0                                  446.0     41.556               0.0          1                  1.0
44      3.0     -4.0           -1.0                                   28.0     24.468               0.0          1                  1.0
45      1.0      1.0           -1.0                                  247.5      3.108               0.0          1                  1.0
46      3.0     -2.0            1.0                                  353.5      0.480               0.0          1                  1.0
47      1.0      2.0           -1.0                                  336.0      1.908               0.0          1                  1.0
/common/home/hg343/Research/accelerate_combo_option/src/market.py:274: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  frontier_labels = pd.Series(None, index=orders.index)
/common/home/hg343/Research/accelerate_combo_option/src/market.py:275: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  quote_prices = pd.Series(None, index=orders.index)  # Create a Series to store quote prices
49      1.0      1.0            1.0                                  248.0     18.084               0.0          1                  1.0
checking match False -0.0
Processing order 0 (1/50)
checking match False -0.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0
Generating frontier for markets:   0%|                                                                                                     | 0/18 [02:13<?, ?it/s]
Traceback (most recent call last):
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 170, in <module>
    frontier_option_label_epsilon, quote_price_epsilon = market.epsilon_frontierGeneration(offset=args.offset)
  File "/common/home/hg343/Research/accelerate_combo_option/src/market.py", line 359, in epsilon_frontierGeneration
    labeled_orders, quote_prices = self.frontierGeneration(orders, epsilon = True, offset = offset)
  File "/common/home/hg343/Research/accelerate_combo_option/src/market.py", line 323, in frontierGeneration
    if row_series['transaction_type'] == 1:  # Buy order
  File "/common/home/hg343/Research/accelerate_combo_option/src/market.py", line 323, in frontierGeneration
    if row_series['transaction_type'] == 1:  # Buy order
  File "/common/home/hg343/anaconda3/lib/python3.9/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/common/home/hg343/anaconda3/lib/python3.9/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/common/home/hg343/anaconda3/lib/python3.9/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/common/home/hg343/anaconda3/lib/python3.9/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/common/home/hg343/anaconda3/lib/python3.9/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/common/home/hg343/anaconda3/lib/python3.9/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 58, in signal_handler
    pool.terminate()
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 654, in terminate
    self._terminate()
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 692, in _terminate_pool
    cls._help_stuff_finish(inqueue, task_handler, len(pool))
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 672, in _help_stuff_finish
    inqueue._rlock.acquire()
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 60, in signal_handler
    sys.exit(1)
  File "/common/home/hg343/anaconda3/lib/python3.9/site-packages/wandb/sdk/lib/exit_hooks.py", line 36, in exit
    self._orig_exit(orig_code)  # type: ignore
SystemExit: 1
48      2.0     -1.0            1.0                                  220.5      4.740               0.0          1                  1.0