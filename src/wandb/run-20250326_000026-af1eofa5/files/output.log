Generating frontier for markets:   0%|                                                            | 0/99 [00:00<?, ?it/s]/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py:80: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  quote_price = pd.Series(index=original_opt_buy_book.index)
There are 27 buy orders and 23 sell orders
#####Generating combinatorial/book/STOCK_2_SEED_2_book_GS_MSFT.npy with size 50 and noise 0.0625#####
Starting async computation for iteration 1
Set parameter Username
Academic license - for non-commercial use only - expires 2025-11-08
Int64Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
            17, 18, 19, 20, 21, 22, 23, 24, 25, 26],
           dtype='int64') {4, 5, 6, 12, 15}
Int64Index([27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43,
            44, 45, 46, 47, 48, 49],
           dtype='int64') {34, 35, 36, 40, 42, 43, 46, 47}
22
15

Checking buy side options:  23%|█████████████▏                                            | 5/22 [00:03<00:09,  1.79it/s]
original bid: 4.58,quoted bid: 4.58
original bid: 0.29,quoted bid: 0.29
original bid: 143.91,quoted bid: 143.90999999999735

Checking buy side options:  41%|███████████████████████▋                                  | 9/22 [00:05<00:06,  1.99it/s]
original bid: 0.12,quoted bid: 0.12
original bid: 31.53,quoted bid: 31.53
original bid: 0.51,quoted bid: 0.51

Checking buy side options:  68%|██████████████████████████████████████▊                  | 15/22 [00:08<00:03,  1.95it/s]
original bid: 0.21,quoted bid: 0.0726668520575656

Checking buy side options:  82%|██████████████████████████████████████████████▋          | 18/22 [00:09<00:02,  1.81it/s]

Checking buy side options:  95%|██████████████████████████████████████████████████████▍  | 21/22 [00:11<00:00,  1.90it/s]
original bid: 42.71,quoted bid: 42.71
original ask: 2.38,quoted ask: 3.633132671006024
order to quote: option1                                    3.00
option2                                   -2.00
C=Call, P=Put                             -1.00
Strike Price of the Option Times 1000    314.00
transaction_type                           0.00
B/A_price                                  2.38
Name: 27, dtype: float64
quote_price: 3.633132671006024
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()
Checking buy side options: 100%|█████████████████████████████████████████████████████████| 22/22 [00:11<00:00,  2.11it/s]

Checking sell side options:   7%|███▊                                                     | 1/15 [01:00<14:13, 60.96s/it]
original ask: 0.49,quoted ask: 1.7388907850254327
order to quote: option1                                    3.00
option2                                   -1.00
C=Call, P=Put                             -1.00
Strike Price of the Option Times 1000    403.50
transaction_type                           0.00
B/A_price                                  0.49
Name: 28, dtype: float64
quote_price: 1.7388907850254327
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()
-> for option_index in tqdm(range(len(opt_sell_book_holder)), desc='Checking sell side options'):
original ask: 0.04,quoted ask: 0.9580023937160149
order to quote: option1                                   1.00
option2                                  -1.00
C=Call, P=Put                            -1.00
Strike Price of the Option Times 1000    28.00
transaction_type                          0.00
B/A_price                                 0.04
Name: 29, dtype: float64
quote_price: 0.9580023937160149
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()


Checking sell side options:  20%|███████████▍                                             | 3/15 [01:13<03:39, 18.28s/it]
order to quote: option1                                     8.00
option2                                     9.00
C=Call, P=Put                              -1.00
Strike Price of the Option Times 1000    2134.50
transaction_type                            0.00
B/A_price                                   1.14
Name: 30, dtype: float64
quote_price: 1.1344469096511602
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()

Checking sell side options:  27%|███████████████▏                                         | 4/15 [01:27<03:04, 16.76s/it]
original ask: 0.04,quoted ask: 0.2922116656554863
order to quote: option1                                    1.00
option2                                    3.00
C=Call, P=Put                             -1.00
Strike Price of the Option Times 1000    364.00
transaction_type                           0.00
B/A_price                                  0.04
Name: 31, dtype: float64
quote_price: 0.2922116656554863
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()

Checking sell side options:  33%|███████████████████                                      | 5/15 [01:35<02:13, 13.34s/it]
original ask: 43.7,quoted ask: 203433.89977503964
order to quote: option1                                   -1.0
option2                                    4.0
C=Call, P=Put                              1.0
Strike Price of the Option Times 1000    188.0
transaction_type                           0.0
B/A_price                                 43.7
Name: 32, dtype: float64
quote_price: 203433.89977503964
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()

Checking sell side options:  47%|██████████████████████████▌                              | 7/15 [01:37<00:52,  6.61s/it]
original ask: 117.32,quoted ask: 1000000.0
order to quote: option1                                     3.00
option2                                     7.00
C=Call, P=Put                               1.00
Strike Price of the Option Times 1000    1221.00
transaction_type                            0.00
B/A_price                                 117.32
Name: 33, dtype: float64
quote_price: 1000000.0
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()

Checking sell side options:  53%|██████████████████████████████▍                          | 8/15 [01:38<00:33,  4.86s/it]
original ask: 0.94,quoted ask: 1.37533164198976
order to quote: option1                                     7.00
option2                                     4.00
C=Call, P=Put                              -1.00
Strike Price of the Option Times 1000    1554.00
transaction_type                            0.00
B/A_price                                   0.94
Name: 37, dtype: float64
quote_price: 1.37533164198976
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()
-> for option_index in tqdm(range(len(opt_sell_book_holder)), desc='Checking sell side options'):
original ask: 0.95,quoted ask: 0.9948999052867293
order to quote: option1                                     7.00
option2                                     8.00
C=Call, P=Put                              -1.00
Strike Price of the Option Times 1000    1875.00
transaction_type                            0.00
B/A_price                                   0.95
Name: 38, dtype: float64
quote_price: 0.9948999052867293
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()

Checking sell side options:  67%|█████████████████████████████████████▎                  | 10/15 [01:43<00:17,  3.44s/it]
original ask: 0.13,quoted ask: 0.7330535280052572
order to quote: option1                                     8.00
option2                                     7.00
C=Call, P=Put                              -1.00
Strike Price of the Option Times 1000    1642.50
transaction_type                            0.00
B/A_price                                   0.13
Name: 39, dtype: float64
quote_price: 0.7330535280052572
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()

Checking sell side options:  80%|████████████████████████████████████████████▊           | 12/15 [01:45<00:06,  2.13s/it]
original ask: 0.74,quoted ask: 1.806808510562405
order to quote: option1                                    3.00
option2                                    2.00
C=Call, P=Put                             -1.00
Strike Price of the Option Times 1000    713.00
transaction_type                           0.00
B/A_price                                  0.74
Name: 41, dtype: float64
quote_price: 1.806808510562405
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()
-> for option_index in tqdm(range(len(opt_sell_book_holder)), desc='Checking sell side options'):
order to quote: option1                                   1.00
option2                                  -1.00
C=Call, P=Put                            -1.00
Strike Price of the Option Times 1000    68.00
transaction_type                          0.00
B/A_price                                 1.59
Name: 44, dtype: float64
quote_price: 0.9672040302539244
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()
-> for option_index in tqdm(range(len(opt_sell_book_holder)), desc='Checking sell side options'):
original ask: 0.92,quoted ask: 1000000.0
order to quote: option1                                    1.00
option2                                    6.00
C=Call, P=Put                             -1.00
Strike Price of the Option Times 1000    725.00
transaction_type                           0.00
B/A_price                                  0.92
Name: 45, dtype: float64
quote_price: 1000000.0
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()

Checking sell side options:  93%|████████████████████████████████████████████████████▎   | 14/15 [01:47<00:01,  1.52s/it]
original ask: 8.37,quoted ask: 51.03423710737843
order to quote: option1                                   5.00
option2                                  -8.00
C=Call, P=Put                            -1.00
Strike Price of the Option Times 1000    39.50
transaction_type                          0.00
B/A_price                                 8.37
Name: 48, dtype: float64
quote_price: 51.03423710737843
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()
-> for option_index in tqdm(range(len(opt_sell_book_holder)), desc='Checking sell side options'):
original ask: 4.36,quoted ask: 1000000.0
order to quote: option1                                    2.00
option2                                    3.00
C=Call, P=Put                             -1.00
Strike Price of the Option Times 1000    680.50
transaction_type                           0.00
B/A_price                                  4.36
Name: 49, dtype: float64
quote_price: 1000000.0
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(262)synthetic_combo_frontier_generation()

Checking sell side options: 100%|████████████████████████████████████████████████████████| 15/15 [01:48<00:00,  1.41s/it]
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py(536)<module>()
-> async_result = pool.apply_async(run_with_timeout, (opt_orders_df, args.offset))
531  	                        # frontier_option_label_attempt_2 = synthetic_combo_frontier_generation(opt_buy_book_new, opt_sell_book_new, opt_l = False, debug=0)
532  	                        # assert frontier_option_label_attempt_2.equals(frontier_option_label_attempt_1_copy)
533  	                        # frontier_option_label = deepcopy(frontier_option_label_attempt_1)
534  	                        result = synthetic_combo_frontier_generation(opt_orders_df, args.offset)
535  	                        breakpoint()
536  ->	                        async_result = pool.apply_async(run_with_timeout, (opt_orders_df, args.offset))
537  	                        # # frontier_option_label = async_result.get(timeout=600)
538  	                        # df = pd.DataFrame(frontier_option_label, columns=['option1', 'option2','C=Call, P=Put',
539  	                        # 'Strike Price of the Option Times 1000',
540  	                        # 'transaction_type', 'B/A_price',
541  	                        # 'belongs_to_frontier'])
    option1  option2  C=Call, P=Put  ...  transaction_type  B/A_price  belongs_to_frontier
0       4.0     -3.0            1.0  ...               1.0     144.83                  0.0
1      -1.0      2.0            1.0  ...               1.0       4.58                  1.0
2       8.0     -3.0           -1.0  ...               1.0       0.29                  1.0
3      -1.0      6.0            1.0  ...               1.0     143.91                  1.0
7       3.0     -1.0            1.0  ...               1.0     157.07                  1.0
8      -1.0      9.0           -1.0  ...               1.0       0.12                  1.0
9       4.0     -5.0            1.0  ...               1.0     115.05                  0.0
10      5.0     -8.0            1.0  ...               1.0      70.60                  0.0
11      5.0     -8.0           -1.0  ...               1.0      31.53                  1.0
13      2.0      1.0           -1.0  ...               1.0       0.51                  1.0
14      5.0     -2.0            1.0  ...               1.0      28.07                  1.0
16     -1.0      4.0           -1.0  ...               1.0       0.21                  1.0
17      3.0     -7.0           -1.0  ...               1.0     186.47                  1.0
18      1.0     -1.0            1.0  ...               1.0      63.75                  0.0
19      5.0      4.0           -1.0  ...               1.0       3.16                  0.0
20      4.0     -3.0           -1.0  ...               1.0     146.28                  0.0
21     -1.0      3.0            1.0  ...               1.0       9.16                  1.0
22      9.0      7.0           -1.0  ...               1.0      62.31                  0.0
23      1.0     -1.0            1.0  ...               1.0      52.57                  0.0
24      8.0     -9.0            1.0  ...               1.0       4.70                  0.0
25      5.0     -7.0           -1.0  ...               1.0     255.48                  0.0
26      7.0     -1.0           -1.0  ...               1.0      42.71                  1.0
27      3.0     -2.0           -1.0  ...               0.0       2.38                  1.0
28      3.0     -1.0           -1.0  ...               0.0       0.49                  1.0
29      1.0     -1.0           -1.0  ...               0.0       0.04                  1.0
30      8.0      9.0           -1.0  ...               0.0       1.14                  0.0
31      1.0      3.0           -1.0  ...               0.0       0.04                  1.0
32     -1.0      4.0            1.0  ...               0.0      43.70                  1.0
33      3.0      7.0            1.0  ...               0.0     117.32                  1.0
37      7.0      4.0           -1.0  ...               0.0       0.94                  1.0
38      7.0      8.0           -1.0  ...               0.0       0.95                  1.0
39      8.0      7.0           -1.0  ...               0.0       0.13                  1.0
41      3.0      2.0           -1.0  ...               0.0       0.74                  1.0
44      1.0     -1.0           -1.0  ...               0.0       1.59                  0.0
45      1.0      6.0           -1.0  ...               0.0       0.92                  1.0
48      5.0     -8.0           -1.0  ...               0.0       8.37                  1.0
49      2.0      3.0           -1.0  ...               0.0       4.36                  1.0
Generating frontier for markets:   0%|                                                            | 0/99 [03:45<?, ?it/s]
Traceback (most recent call last):
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py", line 536, in <module>
    async_result = pool.apply_async(run_with_timeout, (opt_orders_df, args.offset))
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py", line 536, in <module>
    async_result = pool.apply_async(run_with_timeout, (opt_orders_df, args.offset))
  File "/common/home/hg343/anaconda3/lib/python3.9/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/common/home/hg343/anaconda3/lib/python3.9/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/common/home/hg343/anaconda3/lib/python3.9/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/common/home/hg343/anaconda3/lib/python3.9/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/common/home/hg343/anaconda3/lib/python3.9/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/common/home/hg343/anaconda3/lib/python3.9/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor.py", line 59, in signal_handler
    sys.exit(1)
  File "/common/home/hg343/anaconda3/lib/python3.9/site-packages/wandb/sdk/lib/exit_hooks.py", line 36, in exit
    self._orig_exit(orig_code)  # type: ignore
SystemExit: 1
Ctrl+C received. Terminating processes...