
Generating frontier for markets:   0%|                                                                    | 0/99 [00:00<?, ?it/s]
There are 27 buy orders and 23 sell orders
#####Generating market 1 with size 50 and noise 0.03125#####
Starting computation for iteration 1
Generating frontier for markets:   0%|                                                                    | 0/99 [00:00<?, ?it/s]/common/home/hg343/Research/accelerate_combo_option/src/market.py:275: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  frontier_labels = pd.Series(None, index=orders.index)
/common/home/hg343/Research/accelerate_combo_option/src/market.py:276: FutureWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
  quote_prices = pd.Series(None, index=orders.index)  # Create a Series to store quote prices
checking match False -0.0
Processing order 0 (1/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      4.0     -3.0            1.0                                  319.0               1.0     144.22          1
quote price: 151.93
quote_price: 151.93, original_price: 144.22
Processing order 1 (2/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote     -1.0      2.0            1.0                                   12.0               1.0       4.47          1
quote price: 5.56
quote_price: 5.56, original_price: 4.47
Processing order 2 (3/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      8.0     -3.0           -1.0                                 1119.5               1.0       0.29          1
quote price: -0.0
quote_price: -0.0, original_price: 0.29
Processing order 7 (4/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      3.0     -1.0            1.0                                  333.0               1.0     153.38          1
quote price: 140.48
quote_price: 140.48, original_price: 153.38
Processing order 8 (5/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote     -1.0      9.0           -1.0                                  585.0               1.0       0.12          1
quote price: -0.0
quote_price: -0.0, original_price: 0.12
Processing order 9 (6/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      4.0     -5.0            1.0                                  130.0               1.0     114.95          1
quote price: 127.84
quote_price: 127.84, original_price: 114.95
Processing order 10 (7/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      5.0     -8.0            1.0                                   49.0               1.0      68.85          1
quote price: 86.97
quote_price: 86.97, original_price: 68.85
Processing order 11 (8/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      5.0     -8.0           -1.0                                  164.5               1.0      31.12          1
quote price: 38.41
quote_price: 38.41, original_price: 31.12
Processing order 13 (9/36)
checking match False -0.0
quote_price: 0.01, original_price: 0.51
Processing order 14 (10/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      5.0     -2.0            1.0                                  744.5               1.0      27.69          1
quote price: 30.66
quote_price: 30.66, original_price: 27.69
Processing order 16 (11/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote     -1.0      4.0           -1.0                                  189.0               1.0       0.21          1
quote price: 0.05
quote_price: 0.05, original_price: 0.21
Processing order 17 (12/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      3.0     -7.0           -1.0                                   22.0               1.0     181.27          1
quote price: 166.09
quote_price: 166.09, original_price: 181.27
Processing order 18 (13/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      1.0     -1.0            1.0                                   28.0               1.0      62.05          1
quote price: 63.1
quote_price: 63.1, original_price: 62.05
Processing order 19 (14/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      5.0      4.0           -1.0                                 1421.0               1.0       3.15          1
quote price: 8.28
quote_price: 8.28, original_price: 3.15
Processing order 20 (15/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      4.0     -3.0           -1.0                                  618.0               1.0     146.17          1
quote price: 151.71
quote_price: 151.71, original_price: 146.17
Processing order 21 (16/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote     -1.0      3.0            1.0                                  115.5               1.0       9.01          1
quote price: 6.93
quote_price: 6.93, original_price: 9.01
Processing order 22 (17/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      9.0      7.0           -1.0                                 2594.0               1.0      60.59          1
quote price: 72.09
quote_price: 72.09, original_price: 60.59
Processing order 23 (18/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      1.0     -1.0            1.0                                   37.0               1.0      51.96          1
quote price: 54.1
quote_price: 54.1, original_price: 51.96
Processing order 24 (19/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      8.0     -9.0            1.0                                  603.5               1.0       4.67          1
quote price: 18.88
quote_price: 18.88, original_price: 4.67
Processing order 25 (20/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      5.0     -7.0           -1.0                                  489.5               1.0     252.19          1
quote price: 254.74
quote_price: 254.74, original_price: 252.19
Processing order 26 (21/36)
checking match False -0.0
option_to_quote:        option1  option2  C=Call, P=Put  Strike Price of the Option Times 1000  transaction_type  B/A_price  liquidity
quote      7.0     -1.0           -1.0                                 1309.5               1.0      42.67          1
quote price: 39.37
quote_price: 39.37, original_price: 42.67
Processing order 27 (22/36)
checking match False -0.0
quote_price: 3.19, original_price: 2.39
Processing order 28 (23/36)
checking match False -0.0
quote_price: 1.77, original_price: 0.49
Processing order 29 (24/36)
checking match False -0.0
quote_price: 0.98, original_price: 0.04
Processing order 30 (25/36)
checking match False -0.0
quote_price: 1.17, original_price: 1.15
Processing order 31 (26/36)
checking match False -0.0
quote_price: 4.24, original_price: 0.04
Processing order 32 (27/36)
checking match False -0.0
quote_price: 72.06, original_price: 44.01
Processing order 33 (28/36)
checking match False -0.0
quote_price: 123.75, original_price: 119.06
Processing order 35 (29/36)
checking match False -0.0
quote_price: 29.79, original_price: 8.29
Processing order 38 (30/36)
checking match False -0.0
quote_price: 1.03, original_price: 0.97
Processing order 39 (31/36)
checking match False -0.0
quote_price: 0.58, original_price: 0.13
Processing order 40 (32/36)
checking match False -0.0
quote_price: 359.25, original_price: 109.82
Processing order 41 (33/36)
checking match False -0.0
quote_price: 2.42, original_price: 0.76
Processing order 44 (34/36)
checking match False -0.0
quote_price: 0.99, original_price: 1.62
Processing order 48 (35/36)
checking match False -0.0
quote_price: 39.54, original_price: 8.6
Processing order 49 (36/36)
checking match False -0.0
quote_price: 14.88, original_price: 4.45
    option1  option2  C=Call, P=Put  ...  B/A_price  liquidity  belongs_to_frontier
0       4.0     -3.0            1.0  ...     144.22          1                  0.0
1      -1.0      2.0            1.0  ...       4.47          1                  0.0
2       8.0     -3.0           -1.0  ...       0.29          1                  1.0
7       3.0     -1.0            1.0  ...     153.38          1                  1.0
8      -1.0      9.0           -1.0  ...       0.12          1                  1.0
9       4.0     -5.0            1.0  ...     114.95          1                  0.0
10      5.0     -8.0            1.0  ...      68.85          1                  0.0
11      5.0     -8.0           -1.0  ...      31.12          1                  0.0
13      2.0      1.0           -1.0  ...       0.51          1                  1.0
14      5.0     -2.0            1.0  ...      27.69          1                  0.0
16     -1.0      4.0           -1.0  ...       0.21          1                  1.0
17      3.0     -7.0           -1.0  ...     181.27          1                  1.0
18      1.0     -1.0            1.0  ...      62.05          1                  0.0
19      5.0      4.0           -1.0  ...       3.15          1                  0.0
20      4.0     -3.0           -1.0  ...     146.17          1                  0.0
21     -1.0      3.0            1.0  ...       9.01          1                  1.0
22      9.0      7.0           -1.0  ...      60.59          1                  0.0
23      1.0     -1.0            1.0  ...      51.96          1                  0.0
24      8.0     -9.0            1.0  ...       4.67          1                  0.0
25      5.0     -7.0           -1.0  ...     252.19          1                  0.0
26      7.0     -1.0           -1.0  ...      42.67          1                  1.0
27      3.0     -2.0           -1.0  ...       2.39          1                  1.0
28      3.0     -1.0           -1.0  ...       0.49          1                  1.0
29      1.0     -1.0           -1.0  ...       0.04          1                  1.0
30      8.0      9.0           -1.0  ...       1.15          1                  1.0
31      1.0      3.0           -1.0  ...       0.04          1                  1.0
32     -1.0      4.0            1.0  ...      44.01          1                  1.0
33      3.0      7.0            1.0  ...     119.06          1                  1.0
35      3.0      2.0           -1.0  ...       8.29          1                  1.0
38      7.0      8.0           -1.0  ...       0.97          1                  1.0
39      8.0      7.0           -1.0  ...       0.13          1                  1.0
40      9.0      1.0            1.0  ...     109.82          1                  1.0
41      3.0      2.0           -1.0  ...       0.76          1                  1.0
44      1.0     -1.0           -1.0  ...       1.62          1                  0.0
48      5.0     -8.0           -1.0  ...       8.60          1                  1.0
49      2.0      3.0           -1.0  ...       4.45          1                  1.0
[36 rows x 8 columns]
> /common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py(178)<module>()
-> if frontier_option_label_epsilon is not None and not np.isnan(frontier_option_label_epsilon['belongs_to_frontier']).any():
Traceback (most recent call last):
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 178, in <module>
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 178, in <module>
  File "/common/home/hg343/anaconda3/lib/python3.9/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/common/home/hg343/anaconda3/lib/python3.9/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
Generating frontier for markets:   1%|▌                                                       | 1/99 [15:14<24:53:20, 914.29s/it]
Error processing market 1:
There are 34 buy orders and 16 sell orders
#####Generating market 2 with size 50 and noise 0.03125#####
Generating frontier for markets:   1%|▌                                                       | 1/99 [15:16<24:57:00, 916.53s/it]
Traceback (most recent call last):
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 162, in <module>
    )
  File "/common/home/hg343/Research/accelerate_combo_option/src/market.py", line 82, in check_match
    is_match, profit = self.apply_mechanism(orders, offset=offset)
  File "/common/home/hg343/Research/accelerate_combo_option/src/market.py", line 137, in apply_mechanism
    result = async_result.get(timeout=timeout)
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 765, in get
    self.wait(timeout)
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 762, in wait
    self._event.wait(timeout)
  File "/common/home/hg343/anaconda3/lib/python3.9/threading.py", line 574, in wait
    signaled = self._cond.wait(timeout)
  File "/common/home/hg343/anaconda3/lib/python3.9/threading.py", line 316, in wait
    gotit = waiter.acquire(True, timeout)
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 58, in signal_handler
    def signal_handler(signum, frame):
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 654, in terminate
    self._terminate()
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 692, in _terminate_pool
    cls._help_stuff_finish(inqueue, task_handler, len(pool))
  File "/common/home/hg343/anaconda3/lib/python3.9/multiprocessing/pool.py", line 672, in _help_stuff_finish
    inqueue._rlock.acquire()
  File "/common/home/hg343/Research/accelerate_combo_option/src/combo_stock_frontier_data_preprocessor_forked.py", line 60, in signal_handler
    if 'pool' in globals():
  File "/common/home/hg343/anaconda3/lib/python3.9/site-packages/wandb/sdk/lib/exit_hooks.py", line 36, in exit
    self._orig_exit(orig_code)  # type: ignore
SystemExit: 1
Ctrl+C received. Terminating processes...
Ctrl+C received. Terminating processes...